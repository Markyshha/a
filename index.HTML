<!DOCTYPE html>
<html>
<head>
  <title>NFC Магия</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      transition: 0.5s;
      margin-top: 50px;
    }
  </style>
</head>
<body>
  <h1 id="status">Приложи метку...</h1>

  <script>
    let toggle = false;

    async function startNFC() {
      if ("NDEFReader" in window) {
        try {
          const reader = new NDEFReader();
          await reader.scan();
          document.getElementById("status").innerText = "Ожидание метки...";

          reader.onreading = event => {
            const decoder = new TextDecoder();
            for (const record of event.message.records) {
              const data = decoder.decode(record.data);
              if (data === "1") {
                toggle = !toggle;
                if (toggle) {
                  document.body.style.background = "#222";
                  document.body.style.color = "white";
                  document.getElementById("status").innerText = "Метка считана — режим 1 🌙";
                } else {
                  document.body.style.background = "#fff";
                  document.body.style.color = "black";
                  document.getElementById("status").innerText = "Метка считана — режим 2 🌞";
                }
              }
            }
          };
        } catch (error) {
          document.getElementById("status").innerText = "Ошибка: " + error;
        }
      } else {
        document.getElementById("status").innerText = "Web NFC не поддерживается на этом устройстве!";
      }
    }

    startNFC();
  </script>
</body>
</html>
